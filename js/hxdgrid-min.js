(function(){function l(a,c,b,d){var e=Math.floor(c.relW);if(1<e)for(var f=0;f<e;f++)a[c.xCor+f*b]={relW:c.relW,relH:c.relH,yCor:c.yCor,xCor:c.xCor,i:d};else a[c.xCor]={relW:c.relW,relH:c.relH,yCor:c.yCor,xCor:c.xCor,i:d}}function u(a,c,b,d){var e=c,f=0;if("undefined"!==typeof a[c]){if(2<=a[c].relH){e=m(a[e]);2<e.relH&&--e.relH;e.yCor+=b.gridCellSize+b.gridPadding;e.i="pseudoB"+d;l(a,e,b.gridCellSize+b.gridPadding,"pseudoB");for(e=b.gridPadding+b.gridCellSize*a[c].relW+a[c].xCor;"undefined"!==typeof a[e]&&
2<a[e].relH&&(d=a[e],"undefined"!==typeof d);)e=d.xCor+d.relW*b.gridCellSize+b.gridPadding;"undefined"!==typeof a[e]&&(c=e)}f=a[c].yCor+b.gridCellSize+b.gridPadding}else console.log("Error This should not happen index:"+d+" : "+c),f=-1E4;return[e,f]}function m(a){if(null==a||"object"!=typeof a)return a;var c=new a.constructor,b;for(b in a)c[b]=m(a[b]);return c}function n(a){window.getHxGridObj=function(c){return a[c]};window.getHxItemById=function(c){try{var b=c.split("@");return"undefined"===typeof a[parseInt(b[1])].items[parseInt(b[0])]?
(new p("HxdGrid->Access error. Invalid item id. Itemuid: "+b[0]+" RAW:"+c),0):a[parseInt(b[1])].items[parseInt(b[0])]}catch(d){throw new h("HxdGrid->Access error. Invalid ID format. The correct format is ITEMuid@GRIDuid. Current input "+c+". Exception details "+d);}}}function v(a){function c(){200>new Date-b?setTimeout(c,200):d=!1;a.resizeEvent()}var b,d=!1;window.addEventListener("resize",function(a){b=new Date;!1===d&&(d=!0,setTimeout(c,200))})}function w(a,c){for(var b,d=0,e=a.childNodes.length;d<
e;d++)for(var f=void 0!=a.childNodes[d].className?a.childNodes[d].className.split(" "):[],g=0,x=f.length;g<x;g++)f[g]==c&&(b=a.childNodes[d]);return b}function y(a,c,b){a.innerHTML=c+a.innerHTML+b;return a}function q(a,c,b,d){setTimeout(function(){a.style[b]=c},"undefined"===typeof d?1E3:d)}function h(a){this.message=a;this.name="HxdException"}function p(a){for(var c="assert cd clear count countReset debug dir dirxml error exception group groupCollapsed groupEnd info log markTimeline profile profileEnd select table time timeEnd timeStamp timeline timelineEnd trace warn".split(" "),
b=c.length,d=window.console=window.console||{},e,f=function(){};b--;)e=c[b],d[e]||(d[e]=f);d.log("------WARNING------");d.log(a)}var r=0,t=function(a,c,b){this.domElem=a;this.setOptions(c);this.create(this,b)};t.prototype={index:0,domElem:null,xCor:0,yCor:0,gridPadding:5,relW:1,relH:1,viewFade:!0,setOptions:function(a){this.viewFade=a&&a.viewFade||this.viewFade;this.autoBind=a&&a.autoBind||this.autoBind},addAttr:function(a,c){this.hasOwnProperty(a)?new p("HxdError -> Object function. Attempting to override property. Use setAttribute instead"):
this[a]=c},passNodeAttributes:function(a){for(var c=0,b=a.length;c<b;c++){var d=a.item(c);-1<d.name.indexOf("data-hxd-")&&this.addAttr(d.name.replace("data-hxd-",""),d.value)}},create:function(a,c){a.relW=Math.round(a.domElem.offsetWidth/c);a.relH=Math.round(a.domElem.offsetHeight/c);if(1<a.relW){var b=a.gridPadding/c*(a.relW-1);a.relW+=b;a.domElem.style.width=a.relW*c+"px"}1<a.relH&&(b=a.gridPadding/c*(a.relH-1),a.relH+=b,a.domElem.style.height=a.relH*c+"px")},getXY:function(){return[this.xCor,this.yCor]},
swapPos:function(a,c){var b=this.getXY(),d=a.getXY();this.moveTo(d[0],d[1]);a.moveTo(b[0],b[1]);var d=this.uid.split("@")[0],b=this.domElem.parentNode,d="binaryShift"+d,e={0:this,1:a},f;document.createEvent?(f=document.createEvent("HTMLEvents"),f.initEvent("dataavailable",!0,!0,e)):(f=document.createEventObject(),f.eventType="dataavailable");f.eventName=d;document.createEvent?b.dispatchEvent(f):b.fireEvent("on"+f.eventType,f);"undefined"!==typeof c&&c()},moveTo:function(a,c){var b=this.domElem;if("undefined"!==
typeof b.getAttribute("style")&&"absolute"==b.style.position)this.animateOver(a,c);else{var d=b.getAttribute("style");b.setAttribute("style",d+"opacity:1;margin:0!important;float:none;position: absolute;left:"+a+"px;top:"+c+"px")}this.xCor=a;this.yCor=c},animateOver:function(a,c,b){b=b||this.domElem;a+="px";var d=c+"px";b.style.top<c?(b.style.left!=a&&(b.style.left=a),b.style.top!=d&&q(b,d,"top",1E3)):(b.style.top!=d&&(b.style.top=d),b.style.left!=a&&q(b,a,"left",1E3))},isElementInViewport:function(a,
c){var b=this.domElem.getBoundingClientRect();return-100<=b.top&&-100<=b.left&&b.bottom<=(window.innerHeight+100||document.documentElement.clientHeight+100)&&b.right<=(window.innerWidth+100||document.documentElement.clientWidth+100)},moveInViewport:function(a,c){var b=this.domElem.getBoundingClientRect(),d=parseInt(this.domElem.style.top)-c,e=parseInt(this.domElem.style.left)-a;return 0<=b.top-d&&0<=b.left-e&&b.bottom-d<=(window.innerHeight+0||document.documentElement.clientHeight+0)&&b.right-e<=
(window.innerWidth+0||document.documentElement.clientWidth+0)}};var k=function(a,c){try{this.uid=r;this.domElem=a;this.resizeLock=!0;this.items=[];var b;b=0<window.navigator.userAgent.indexOf("MSIE ")||navigator.userAgent.match(/Trident.*rv\:11\./)?!0:!1;b?a.className+="hxdGridContainer":a.classList.add("hxdGridContainer");a.setAttribute("style","list-style: none;width: 100%; height: 100%; overflow: hidden;  position: relative;");this.setOptions(c);this.create(this);v(this);r++}catch(d){throw new h("HxdGrid-> Grid initialization error. Detais: "+
d);}};k.prototype={uid:0,domElem:null,resize:!0,gridCellSize:80,gridCellsWidth:0,gridPadding:5,volume:0,selector:".hxdItem",hiddenItems:[],cellOptions:{},setOptions:function(a){this.autocenter=a&&!1!==a.autocenter||!1;this.resize=a&&a.resize||this.resize;this.selector=a&&a.selector||this.selector;this.cellOptions.autoBind=a&&a.autoBind||!1;this.cellOptions.viewFade=a&&a.viewFade||!1},create:function(a){a.reflowLevel=0;a._boundaryWrap(a.domElem,a);for(var c=a.domElem.querySelectorAll(a.selector),b=
0,d=c.length;b<d;b++)c[b].innerHTML=b,a.items[b]=new t(c[b],a.cellOptions,a.gridCellSize),a.items[b].index=b,a.volume+=a.items[b].relH+a.items[b].relW;a.positionItems()},_boundaryWrap:function(a,c){this.gridCellsWidth=Math.floor(a.offsetWidth/this.gridCellSize);var b=y(a,"<div class='blockGrid' style='height: 100vh'>","</div>"),d=document.createEvent("Event");d.initEvent("dataavailable",!0,!0);w(b,"blockGrid").addEventListener(d,function(a,b){},!1)},_calculateHeight:function(){this.domElem.style.height=
this.gridCellSize*this.gridCellSize*this.volume/this.domElem.offsetWidth+"px"},resizeEvent:function(){console.log("resize");this.gridCellsWidth=Math.floor(this.domElem.offsetWidth/this.gridCellSize);this.positionItems()},positionItems:function(){var a=(new Date).getTime(),c=0,b=0,d={},e=!0;console.log("---------");for(var f=0,g=this.items.length;f<g;f++)0<f&&(c=this.gridPadding+this.gridCellSize*this.items[f-1].relW+this.items[f-1].xCor,c+this.gridCellsWidth*this.items[f].relW>this.gridCellsWidth*
this.gridCellSize&&(c=0,e=!1),e||(b=u(d,c,this,f),c=b[0],b=b[1])),this.items[f].moveTo(c,b),l(d,this.items[f],this.gridCellSize+this.gridPadding,f);a=(new Date).getTime()-a;this._calculateHeight();this.items.sort(function(a,b){return a.index<b.index?-1:a.index>b.index?1:0});console.log("Execution time: "+a)}};"undefined"!==typeof jQuery&&(jQuery.fn.hxdGrid=function(a){var c=[];n(c);return this.each(function(b){c[b]=new k(this,a)})});window.hxdgrid=function(a,c){var b=[];n(b);for(var d=document.querySelectorAll(a),
e=0,f=d.length;e<f;e++)b[e]=new k(d[e],c);return 1==f?b[0]:b};h.prototype=Error()})();
